
#Import scikit-learn metrics module for accuracy calculation
from sklearn import metrics
import numpy as np
from sklearn import svm
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import accuracy_score
import matplotlib.pyplot as plt

def compute_orientation_feature(strokes, angle):
    radians = np.deg2rad(angle)
    reference_vector = np.array([np.cos(radians), np.sin(radians)])
    feature = np.zeros((24, 24))
    for stroke in strokes:
        for point in stroke:
            vector = np.array([point['x'], point['y']])
            similarity = np.dot(vector, reference_vector) / (np.linalg.norm(vector) * np.linalg.norm(reference_vector))
            similarity = max(0, min(1, similarity))  # Clamp values to [0, 1]
            grid_x = min(int(point['x'] // (24 / 24)), 23)
            grid_y = min(int(point['y'] // (24 / 24)), 23)
            feature[grid_y, grid_x] = max(feature[grid_y, grid_x], similarity)
    return feature

def compute_endpoint_feature(strokes):
    feature = np.zeros((24, 24))
    for stroke in strokes:
        for point in [stroke[0], stroke[-1]]:  # Only endpoints
            grid_x = min(int(point['x'] // (24 / 24)), 23)
            grid_y = min(int(point['y'] // (24 / 24)), 23)
            feature[grid_y, grid_x] = 1
    return feature

def extract_features(strokes):
    features = []
    for stroke in strokes:
        for point in stroke:
            features.extend([point['x'], point['y']])
    return features
   

strokes_rect_easy_two_strokes = [[{'x': 3, 'y': 1}, {'x': 2, 'y': 1}, {'x': 1, 'y': 1}, {'x': 1, 'y': 2}, {'x': 1, 'y': 3}, {'x': 1, 'y': 4}],[{'x': 1, 'y': 4}, {'x': 2, 'y': 4}, {'x': 3, 'y': 4}, {'x': 3, 'y': 3}, {'x': 3, 'y': 2}, {'x': 3, 'y': 1}]]
strokes_rect_easy_one_strokes = [[{'x': 3, 'y': 1}, {'x': 2, 'y': 1}, {'x': 1, 'y': 1}, {'x': 1, 'y': 2}, {'x': 1, 'y': 3}, {'x': 1, 'y': 4}, {'x': 2, 'y': 4}, {'x': 3, 'y': 4}, {'x': 3, 'y': 3}, {'x': 3, 'y': 2}, {'x': 3, 'y': 1}]]
strokes_rect_easy_three_strokes = [[{'x': 3, 'y': 1}, {'x': 2, 'y': 1}, {'x': 1, 'y': 1}], [{'x': 1, 'y': 1},{'x': 1, 'y': 2}, {'x': 1, 'y': 3}, {'x': 1, 'y': 4}, {'x': 2, 'y': 4}, {'x': 3, 'y': 4}], [{'x': 3, 'y': 4}, {'x': 3, 'y': 3}, {'x': 3, 'y': 2}, {'x': 3, 'y': 1}]]
strokes_rect_easy_four_strokes = [[{'x': 3, 'y': 1}, {'x': 2, 'y': 1}, {'x': 1, 'y': 1}], [{'x': 1, 'y': 1}, {'x': 1, 'y': 2}, {'x': 1, 'y': 3}, {'x': 1, 'y': 4}],[{'x': 1, 'y': 4}, {'x': 2, 'y': 4}, {'x': 3, 'y': 4}],[{'x': 3, 'y': 4}, {'x': 3, 'y': 3}, {'x': 3, 'y': 2}, {'x': 3, 'y': 1}]]
strokes_ellipse2 = [[{'x': 5610, 'y': 85, 't': 0}, {'x': 5578, 'y': 87}, {'x': 5546, 'y': 87}, {'x': 5514, 'y': 87}, {'x': 5482, 'y': 87}, {'x': 5450, 'y': 87}, {'x': 5418, 'y': 87}, {'x': 5386, 'y': 89}, {'x': 5354, 'y': 93}, {'x': 5322, 'y': 96}, {'x': 5290, 'y': 101}, {'x': 5259, 'y': 108}, {'x': 5227, 'y': 109}, {'x': 5195, 'y': 115}, {'x': 5163, 'y': 119}, {'x': 5131, 'y': 120}, {'x': 5099, 'y': 123}, {'x': 5067, 'y': 124}, {'x': 5035, 'y': 129}, {'x': 5004, 'y': 136}, {'x': 4973, 'y': 146}, {'x': 4942, 'y': 155}, {'x': 4913, 'y': 168}, {'x': 4883, 'y': 179}, {'x': 4853, 'y': 190}, {'x': 4824, 'y': 202}, {'x': 4795, 'y': 215}, {'x': 4766, 'y': 227}, {'x': 4737, 'y': 240}, {'x': 4709, 'y': 255}, {'x': 4680, 'y': 269}, {'x': 4652, 'y': 285}, {'x': 4624, 'y': 300}, {'x': 4596, 'y': 315}, {'x': 4569, 'y': 333}, {'x': 4541, 'y': 348}, {'x': 4513, 'y': 363}, {'x': 4485, 'y': 379}, {'x': 4459, 'y': 397}, {'x': 4433, 'y': 416}, {'x': 4408, 'y': 436}, {'x': 4382, 'y': 454}, {'x': 4356, 'y': 473}, {'x': 4333, 'y': 496}, {'x': 4309, 'y': 517}, {'x': 4286, 'y': 539}, {'x': 4262, 'y': 561}, {'x': 4243, 'y': 586}, {'x': 4220, 'y': 608}, {'x': 4199, 'y': 632}, {'x': 4177, 'y': 655}, {'x': 4154, 'y': 677}, {'x': 4133, 'y': 701}, {'x': 4116, 'y': 728}, {'x': 4099, 'y': 755}, {'x': 4086, 'y': 784}, {'x': 4076, 'y': 814}, {'x': 4068, 'y': 845}, {'x': 4064, 'y': 877}, {'x': 4064, 'y': 909}, {'x': 4064, 'y': 941}, {'x': 4072, 'y': 972}, {'x': 4078, 'y': 1004}, {'x': 4081, 'y': 1036}, {'x': 4081, 'y': 1068}, {'x': 4081, 'y': 1100}, {'x': 4081, 'y': 1132}, {'x': 4080, 'y': 1164}, {'x': 4080, 'y': 1196}, {'x': 4081, 'y': 1228}, {'x': 4086, 'y': 1260}, {'x': 4095, 'y': 1291}, {'x': 4104, 'y': 1322}, {'x': 4117, 'y': 1351}, {'x': 4127, 'y': 1382}, {'x': 4141, 'y': 1411}, {'x': 4154, 'y': 1440}, {'x': 4166, 'y': 1470}, {'x': 4178, 'y': 1500}, {'x': 4192, 'y': 1529}, {'x': 4204, 'y': 1558}, {'x': 4222, 'y': 1585}, {'x': 4243, 'y': 1609}, {'x': 4265, 'y': 1632}, {'x': 4290, 'y': 1652}, {'x': 4315, 'y': 1672}, {'x': 4341, 'y': 1690}, {'x': 4368, 'y': 1707}, {'x': 4396, 'y': 1722}, {'x': 4425, 'y': 1736}, {'x': 4453, 'y': 1751}, {'x': 4481, 'y': 1766}, {'x': 4511, 'y': 1778}, {'x': 4541, 'y': 1789}, {'x': 4572, 'y': 1799}, {'x': 4603, 'y': 1807}, {'x': 4634, 'y': 1816}, {'x': 4665, 'y': 1826}, {'x': 4696, 'y': 1835}, {'x': 4727, 'y': 1845}, {'x': 4757, 'y': 1855}, {'x': 4788, 'y': 1864}, {'x': 4818, 'y': 1874}, {'x': 4848, 'y': 1886}, {'x': 4878, 'y': 1897}, {'x': 4909, 'y': 1907}, {'x': 4939, 'y': 1919}, {'x': 4969, 'y': 1930}, {'x': 4999, 'y': 1941}, {'x': 5029, 'y': 1952}, {'x': 5060, 'y': 1960}, {'x': 5091, 'y': 1969}, {'x': 5122, 'y': 1978}, {'x': 5153, 'y': 1984}, {'x': 5184, 'y': 1990}, {'x': 5216, 'y': 1996}, {'x': 5248, 'y': 2001}, {'x': 5280, 'y': 2006}, {'x': 5312, 'y': 2010}, {'x': 5344, 'y': 2013}, {'x': 5376, 'y': 2015}, {'x': 5408, 'y': 2017}, {'x': 5440, 'y': 2018}, {'x': 5472, 'y': 2020}, {'x': 5504, 'y': 2021}, {'x': 5536, 'y': 2021}, {'x': 5568, 'y': 2021}, {'x': 5600, 'y': 2021}, {'x': 5632, 'y': 2021}, {'x': 5664, 'y': 2021}, {'x': 5696, 'y': 2023}, {'x': 5728, 'y': 2025}, {'x': 5760, 'y': 2025}, {'x': 5792, 'y': 2026}, {'x': 5824, 'y': 2028}, {'x': 5856, 'y': 2028}, {'x': 5888, 'y': 2028}, {'x': 5920, 'y': 2028}, {'x': 5952, 'y': 2028}, {'x': 5984, 'y': 2028}, {'x': 6016, 'y': 2028}, {'x': 6048, 'y': 2028}, {'x': 6080, 'y': 2028}, {'x': 6112, 'y': 2028}, {'x': 6144, 'y': 2028}, {'x': 6176, 'y': 2028}, {'x': 6208, 'y': 2028}, {'x': 6240, 'y': 2028}, {'x': 6272, 'y': 2028}, {'x': 6304, 'y': 2028}, {'x': 6336, 'y': 2027}, {'x': 6368, 'y': 2026}, {'x': 6400, 'y': 2022}, {'x': 6432, 'y': 2022}, {'x': 6464, 'y': 2022}, {'x': 6496, 'y': 2021}, {'x': 6528, 'y': 2018}, {'x': 6560, 'y': 2017}, {'x': 6592, 'y': 2016}, {'x': 6624, 'y': 2016}, {'x': 6656, 'y': 2015}, {'x': 6688, 'y': 2014}, {'x': 6720, 'y': 2014}, {'x': 6752, 'y': 2013}, {'x': 6784, 'y': 2011}, {'x': 6816, 'y': 2009}, {'x': 6848, 'y': 2007}, {'x': 6880, 'y': 2005}, {'x': 6912, 'y': 2004}, {'x': 6944, 'y': 2002}, {'x': 6976, 'y': 2000}, {'x': 7008, 'y': 1999}, {'x': 7040, 'y': 1997}, {'x': 7072, 'y': 1996}, {'x': 7104, 'y': 1995}, {'x': 7136, 'y': 1993}, {'x': 7168, 'y': 1992}, {'x': 7200, 'y': 1991}, {'x': 7232, 'y': 1990}, {'x': 7264, 'y': 1989}, {'x': 7296, 'y': 1986}, {'x': 7328, 'y': 1982}, {'x': 7360, 'y': 1978}, {'x': 7392, 'y': 1975}, {'x': 7423, 'y': 1968}, {'x': 7455, 'y': 1962}, {'x': 7486, 'y': 1955}, {'x': 7517, 'y': 1946}, {'x': 7547, 'y': 1934}, {'x': 7577, 'y': 1923}, {'x': 7607, 'y': 1913}, {'x': 7637, 'y': 1901}, {'x': 7667, 'y': 1889}, {'x': 7697, 'y': 1877}, {'x': 7727, 'y': 1867}, {'x': 7757, 'y': 1855}, {'x': 7787, 'y': 1844}, {'x': 7817, 'y': 1832}, {'x': 7847, 'y': 1822}, {'x': 7876, 'y': 1809}, {'x': 7905, 'y': 1796}, {'x': 7935, 'y': 1785}, {'x': 7965, 'y': 1773}, {'x': 7995, 'y': 1762}, {'x': 8025, 'y': 1749}, {'x': 8055, 'y': 1737}, {'x': 8084, 'y': 1724}, {'x': 8113, 'y': 1711}, {'x': 8142, 'y': 1698}, {'x': 8171, 'y': 1685}, {'x': 8198, 'y': 1668}, {'x': 8226, 'y': 1652}, {'x': 8252, 'y': 1634}, {'x': 8277, 'y': 1614}, {'x': 8301, 'y': 1593}, {'x': 8325, 'y': 1572}, {'x': 8347, 'y': 1549}, {'x': 8368, 'y': 1525}, {'x': 8390, 'y': 1501}, {'x': 8410, 'y': 1476}, {'x': 8427, 'y': 1449}, {'x': 8445, 'y': 1422}, {'x': 8460, 'y': 1394}, {'x': 8475, 'y': 1366}, {'x': 8488, 'y': 1337}, {'x': 8499, 'y': 1307}, {'x': 8509, 'y': 1277}, {'x': 8517, 'y': 1246}, {'x': 8525, 'y': 1215}, {'x': 8533, 'y': 1184}, {'x': 8539, 'y': 1153}, {'x': 8542, 'y': 1121}, {'x': 8546, 'y': 1089}, {'x': 8549, 'y': 1057}, {'x': 8549, 'y': 1025}, {'x': 8549, 'y': 993}, {'x': 8549, 'y': 961}, {'x': 8548, 'y': 929}, {'x': 8544, 'y': 897}, {'x': 8540, 'y': 865}, {'x': 8533, 'y': 834}, {'x': 8524, 'y': 803}, {'x': 8511, 'y': 774}, {'x': 8495, 'y': 746}, {'x': 8476, 'y': 720}, {'x': 8455, 'y': 696}, {'x': 8435, 'y': 671}, {'x': 8413, 'y': 647}, {'x': 8391, 'y': 624}, {'x': 8370, 'y': 600}, {'x': 8348, 'y': 576}, {'x': 8323, 'y': 556}, {'x': 8299, 'y': 535}, {'x': 8274, 'y': 515}, {'x': 8249, 'y': 495}, {'x': 8222, 'y': 478}, {'x': 8195, 'y': 461}, {'x': 8167, 'y': 445}, {'x': 8140, 'y': 429}, {'x': 8113, 'y': 412}, {'x': 8086, 'y': 395}, {'x': 8059, 'y': 377}, {'x': 8032, 'y': 359}, {'x': 8005, 'y': 342}, {'x': 7978, 'y': 325}, {'x': 7955, 'y': 303}, {'x': 7928, 'y': 286}, {'x': 7900, 'y': 270}, {'x': 7873, 'y': 253}, {'x': 7845, 'y': 238}, {'x': 7817, 'y': 223}, {'x': 7788, 'y': 209}, {'x': 7757, 'y': 201}, {'x': 7727, 'y': 190}, {'x': 7696, 'y': 181}, {'x': 7666, 'y': 170}, {'x': 7635, 'y': 164}, {'x': 7604, 'y': 157}, {'x': 7572, 'y': 151}, {'x': 7540, 'y': 145}, {'x': 7508, 'y': 140}, {'x': 7477, 'y': 131}, {'x': 7446, 'y': 125}, {'x': 7414, 'y': 120}, {'x': 7383, 'y': 112}, {'x': 7352, 'y': 105}, {'x': 7320, 'y': 99}, {'x': 7288, 'y': 94}, {'x': 7256, 'y': 90}, {'x': 7225, 'y': 83}, {'x': 7193, 'y': 80}, {'x': 7162, 'y': 74}, {'x': 7131, 'y': 68}, {'x': 7099, 'y': 63}, {'x': 7067, 'y': 59}, {'x': 7035, 'y': 55}, {'x': 7003, 'y': 50}, {'x': 6971, 'y': 46}, {'x': 6939, 'y': 43}, {'x': 6908, 'y': 34}, {'x': 6876, 'y': 29}, {'x': 6844, 'y': 27}, {'x': 6812, 'y': 27}, {'x': 6780, 'y': 22}, {'x': 6748, 'y': 17}, {'x': 6716, 'y': 15}, {'x': 6684, 'y': 12}, {'x': 6652, 'y': 9}, {'x': 6620, 'y': 7}, {'x': 6588, 'y': 6}, {'x': 6556, 'y': 4}, {'x': 6524, 'y': 2}, {'x': 6492, 'y': 2}, {'x': 6460, 'y': 1}, {'x': 6428, 'y': 1}, {'x': 6396, 'y': 1}, {'x': 6364, 'y': 1}, {'x': 6332, 'y': 0}, {'x': 6300, 'y': 0}, {'x': 6268, 'y': 0}, {'x': 6236, 'y': 0}, {'x': 6204, 'y': 0}, {'x': 6172, 'y': 0}, {'x': 6140, 'y': 0}, {'x': 6108, 'y': 2}, {'x': 6076, 'y': 4}, {'x': 6044, 'y': 6}, {'x': 6012, 'y': 7}, {'x': 5980, 'y': 7}, {'x': 5948, 'y': 7}, {'x': 5916, 'y': 7}, {'x': 5884, 'y': 9}, {'x': 5852, 'y': 9}, {'x': 5820, 'y': 9}, {'x': 5788, 'y': 9}, {'x': 5756, 'y': 10}, {'x': 5724, 'y': 13}, {'x': 5692, 'y': 16}, {'x': 5660, 'y': 18}, {'x': 5628, 'y': 22}, {'x': 5596, 'y': 26}, {'x': 5564, 'y': 27}, {'x': 5532, 'y': 28}, {'x': 5500, 'y': 31}, {'x': 5468, 'y': 34}, {'x': 5436, 'y': 38}, {'x': 5404, 'y': 42}, {'x': 5372, 'y': 45}, {'x': 5340, 'y': 47}, {'x': 5317, 'y': 49, 't': 3261}]]
strokes_ellipse1 =  [[{'x': 4148, 'y': 20261, 't': 0}, {'x': 4167, 'y': 20274}, {'x': 4199, 'y': 20270}, {'x': 4230, 'y': 20261}, {'x': 4261, 'y': 20252}, {'x': 4291, 'y': 20240}, {'x': 4321, 'y': 20229}, {'x': 4352, 'y': 20221}, {'x': 4383, 'y': 20213}, {'x': 4414, 'y': 20205}, {'x': 4445, 'y': 20197}, {'x': 4476, 'y': 20188}, {'x': 4506, 'y': 20178}, {'x': 4536, 'y': 20166}, {'x': 4566, 'y': 20154}, {'x': 4596, 'y': 20144}, {'x': 4626, 'y': 20134}, {'x': 4657, 'y': 20127}, {'x': 4689, 'y': 20121}, {'x': 4721, 'y': 20117}, {'x': 4752, 'y': 20110}, {'x': 4783, 'y': 20103}, {'x': 4813, 'y': 20092}, {'x': 4843, 'y': 20081}, {'x': 4874, 'y': 20073}, {'x': 4905, 'y': 20064}, {'x': 4936, 'y': 20056}, {'x': 4967, 'y': 20050}, {'x': 4999, 'y': 20045}, {'x': 5031, 'y': 20042}, {'x': 5063, 'y': 20038}, {'x': 5095, 'y': 20036}, {'x': 5127, 'y': 20036}, {'x': 5159, 'y': 20036}, {'x': 5191, 'y': 20036}, {'x': 5223, 'y': 20036}, {'x': 5255, 'y': 20036}, {'x': 5287, 'y': 20034}, {'x': 5319, 'y': 20032}, {'x': 5351, 'y': 20031}, {'x': 5383, 'y': 20030}, {'x': 5415, 'y': 20030}, {'x': 5447, 'y': 20030}, {'x': 5479, 'y': 20030}, {'x': 5511, 'y': 20032}, {'x': 5543, 'y': 20035}, {'x': 5575, 'y': 20037}, {'x': 5607, 'y': 20040}, {'x': 5639, 'y': 20044}, {'x': 5671, 'y': 20049}, {'x': 5702, 'y': 20057}, {'x': 5733, 'y': 20065}, {'x': 5765, 'y': 20070}, {'x': 5797, 'y': 20074}, {'x': 5829, 'y': 20076}, {'x': 5861, 'y': 20078}, {'x': 5893, 'y': 20080}, {'x': 5925, 'y': 20082}, {'x': 5957, 'y': 20084}, {'x': 5989, 'y': 20086}, {'x': 6021, 'y': 20088}, {'x': 6053, 'y': 20088}, {'x': 6085, 'y': 20088}, {'x': 6117, 'y': 20089}, {'x': 6149, 'y': 20089}, {'x': 6181, 'y': 20091}, {'x': 6213, 'y': 20091}, {'x': 6245, 'y': 20091}, {'x': 6277, 'y': 20091}, {'x': 6309, 'y': 20091}, {'x': 6341, 'y': 20091}, {'x': 6373, 'y': 20091}, {'x': 6405, 'y': 20088}, {'x': 6437, 'y': 20087}, {'x': 6469, 'y': 20084}, {'x': 6501, 'y': 20081}, {'x': 6533, 'y': 20079}, {'x': 6565, 'y': 20077}, {'x': 6597, 'y': 20076}, {'x': 6629, 'y': 20075}, {'x': 6661, 'y': 20075}, {'x': 6693, 'y': 20075}, {'x': 6725, 'y': 20075}, {'x': 6757, 'y': 20075}, {'x': 6789, 'y': 20075}, {'x': 6821, 'y': 20079}, {'x': 6853, 'y': 20080}, {'x': 6885, 'y': 20081}, {'x': 6917, 'y': 20082}, {'x': 6949, 'y': 20082}, {'x': 6981, 'y': 20082}, {'x': 7013, 'y': 20083}, {'x': 7045, 'y': 20084}, {'x': 7077, 'y': 20087}, {'x': 7109, 'y': 20091}, {'x': 7141, 'y': 20093}, {'x': 7173, 'y': 20098}, {'x': 7205, 'y': 20102}, {'x': 7237, 'y': 20105}, {'x': 7269, 'y': 20108}, {'x': 7301, 'y': 20112}, {'x': 7333, 'y': 20117}, {'x': 7365, 'y': 20123}, {'x': 7397, 'y': 20128}, {'x': 7428, 'y': 20136}, {'x': 7459, 'y': 20144}, {'x': 7490, 'y': 20153}, {'x': 7520, 'y': 20163}, {'x': 7551, 'y': 20172}, {'x': 7582, 'y': 20182}, {'x': 7613, 'y': 20192}, {'x': 7644, 'y': 20202}, {'x': 7674, 'y': 20212}, {'x': 7704, 'y': 20222}, {'x': 7735, 'y': 20231}, {'x': 7765, 'y': 20243}, {'x': 7795, 'y': 20254}, {'x': 7825, 'y': 20266}, {'x': 7855, 'y': 20278}, {'x': 7884, 'y': 20291}, {'x': 7913, 'y': 20304}, {'x': 7942, 'y': 20318}, {'x': 7971, 'y': 20332}, {'x': 7999, 'y': 20348}, {'x': 8026, 'y': 20365}, {'x': 8053, 'y': 20382}, {'x': 8078, 'y': 20402}, {'x': 8103, 'y': 20422}, {'x': 8126, 'y': 20445}, {'x': 8149, 'y': 20468}, {'x': 8170, 'y': 20493}, {'x': 8193, 'y': 20516}, {'x': 8213, 'y': 20541}, {'x': 8233, 'y': 20566}, {'x': 8253, 'y': 20591}, {'x': 8272, 'y': 20617}, {'x': 8289, 'y': 20644}, {'x': 8306, 'y': 20671}, {'x': 8321, 'y': 20700}, {'x': 8337, 'y': 20728}, {'x': 8352, 'y': 20756}, {'x': 8368, 'y': 20784}, {'x': 8383, 'y': 20812}, {'x': 8399, 'y': 20840}, {'x': 8411, 'y': 20870}, {'x': 8424, 'y': 20899}, {'x': 8433, 'y': 20930}, {'x': 8442, 'y': 20961}, {'x': 8452, 'y': 20992}, {'x': 8462, 'y': 21023}, {'x': 8471, 'y': 21054}, {'x': 8482, 'y': 21084}, {'x': 8491, 'y': 21115}, {'x': 8498, 'y': 21146}, {'x': 8502, 'y': 21178}, {'x': 8505, 'y': 21210}, {'x': 8505, 'y': 21242}, {'x': 8505, 'y': 21274}, {'x': 8499, 'y': 21306}, {'x': 8492, 'y': 21337}, {'x': 8483, 'y': 21368}, {'x': 8472, 'y': 21398}, {'x': 8459, 'y': 21428}, {'x': 8444, 'y': 21456}, {'x': 8426, 'y': 21482}, {'x': 8405, 'y': 21506}, {'x': 8383, 'y': 21530}, {'x': 8358, 'y': 21550}, {'x': 8332, 'y': 21569}, {'x': 8307, 'y': 21589}, {'x': 8281, 'y': 21607}, {'x': 8253, 'y': 21622}, {'x': 8224, 'y': 21635}, {'x': 8194, 'y': 21648}, {'x': 8163, 'y': 21657}, {'x': 8132, 'y': 21667}, {'x': 8101, 'y': 21675}, {'x': 8070, 'y': 21683}, {'x': 8039, 'y': 21690}, {'x': 8008, 'y': 21697}, {'x': 7976, 'y': 21703}, {'x': 7945, 'y': 21709}, {'x': 7913, 'y': 21714}, {'x': 7881, 'y': 21718}, {'x': 7849, 'y': 21723}, {'x': 7817, 'y': 21728}, {'x': 7785, 'y': 21733}, {'x': 7754, 'y': 21741}, {'x': 7722, 'y': 21747}, {'x': 7691, 'y': 21755}, {'x': 7660, 'y': 21763}, {'x': 7629, 'y': 21771}, {'x': 7598, 'y': 21780}, {'x': 7567, 'y': 21788}, {'x': 7536, 'y': 21798}, {'x': 7505, 'y': 21807}, {'x': 7474, 'y': 21815}, {'x': 7443, 'y': 21825}, {'x': 7412, 'y': 21832}, {'x': 7381, 'y': 21839}, {'x': 7350, 'y': 21845}, {'x': 7318, 'y': 21851}, {'x': 7286, 'y': 21855}, {'x': 7254, 'y': 21860}, {'x': 7222, 'y': 21864}, {'x': 7190, 'y': 21869}, {'x': 7158, 'y': 21871}, {'x': 7126, 'y': 21874}, {'x': 7094, 'y': 21877}, {'x': 7062, 'y': 21879}, {'x': 7030, 'y': 21880}, {'x': 6998, 'y': 21881}, {'x': 6966, 'y': 21882}, {'x': 6934, 'y': 21882}, {'x': 6902, 'y': 21884}, {'x': 6870, 'y': 21885}, {'x': 6838, 'y': 21887}, {'x': 6806, 'y': 21889}, {'x': 6774, 'y': 21890}, {'x': 6742, 'y': 21893}, {'x': 6710, 'y': 21895}, {'x': 6678, 'y': 21896}, {'x': 6646, 'y': 21897}, {'x': 6614, 'y': 21899}, {'x': 6582, 'y': 21901}, {'x': 6550, 'y': 21902}, {'x': 6518, 'y': 21903}, {'x': 6486, 'y': 21905}, {'x': 6454, 'y': 21907}, {'x': 6422, 'y': 21908}, {'x': 6390, 'y': 21909}, {'x': 6358, 'y': 21909}, {'x': 6326, 'y': 21909}, {'x': 6294, 'y': 21909}, {'x': 6262, 'y': 21909}, {'x': 6230, 'y': 21909}, {'x': 6198, 'y': 21909}, {'x': 6166, 'y': 21909}, {'x': 6134, 'y': 21908}, {'x': 6102, 'y': 21905}, {'x': 6070, 'y': 21901}, {'x': 6038, 'y': 21897}, {'x': 6006, 'y': 21892}, {'x': 5974, 'y': 21887}, {'x': 5942, 'y': 21881}, {'x': 5911, 'y': 21875}, {'x': 5880, 'y': 21869}, {'x': 5848, 'y': 21863}, {'x': 5816, 'y': 21857}, {'x': 5784, 'y': 21851}, {'x': 5752, 'y': 21846}, {'x': 5720, 'y': 21841}, {'x': 5688, 'y': 21836}, {'x': 5656, 'y': 21831}, {'x': 5624, 'y': 21827}, {'x': 5593, 'y': 21821}, {'x': 5561, 'y': 21816}, {'x': 5529, 'y': 21812}, {'x': 5497, 'y': 21807}, {'x': 5465, 'y': 21801}, {'x': 5433, 'y': 21795}, {'x': 5401, 'y': 21789}, {'x': 5369, 'y': 21783}, {'x': 5337, 'y': 21777}, {'x': 5306, 'y': 21770}, {'x': 5274, 'y': 21764}, {'x': 5243, 'y': 21757}, {'x': 5212, 'y': 21750}, {'x': 5181, 'y': 21743}, {'x': 5150, 'y': 21736}, {'x': 5119, 'y': 21729}, {'x': 5088, 'y': 21721}, {'x': 5057, 'y': 21714}, {'x': 5026, 'y': 21706}, {'x': 4995, 'y': 21699}, {'x': 4964, 'y': 21690}, {'x': 4933, 'y': 21682}, {'x': 4902, 'y': 21673}, {'x': 4872, 'y': 21662}, {'x': 4842, 'y': 21651}, {'x': 4812, 'y': 21640}, {'x': 4782, 'y': 21627}, {'x': 4752, 'y': 21615}, {'x': 4723, 'y': 21602}, {'x': 4694, 'y': 21589}, {'x': 4664, 'y': 21577}, {'x': 4635, 'y': 21563}, {'x': 4605, 'y': 21551}, {'x': 4575, 'y': 21539}, {'x': 4545, 'y': 21526}, {'x': 4515, 'y': 21514}, {'x': 4485, 'y': 21502}, {'x': 4455, 'y': 21490}, {'x': 4425, 'y': 21477}, {'x': 4396, 'y': 21463}, {'x': 4368, 'y': 21448}, {'x': 4339, 'y': 21434}, {'x': 4312, 'y': 21417}, {'x': 4285, 'y': 21400}, {'x': 4262, 'y': 21379}, {'x': 4239, 'y': 21357}, {'x': 4218, 'y': 21333}, {'x': 4199, 'y': 21307}, {'x': 4180, 'y': 21281}, {'x': 4162, 'y': 21254}, {'x': 4145, 'y': 21227}, {'x': 4129, 'y': 21199}, {'x': 4114, 'y': 21171}, {'x': 4098, 'y': 21143}, {'x': 4083, 'y': 21115}, {'x': 4072, 'y': 21085}, {'x': 4060, 'y': 21055}, {'x': 4052, 'y': 21024}, {'x': 4046, 'y': 20992}, {'x': 4041, 'y': 20960}, {'x': 4035, 'y': 20929}, {'x': 4032, 'y': 20897}, {'x': 4028, 'y': 20865}, {'x': 4025, 'y': 20833}, {'x': 4024, 'y': 20801}, {'x': 4022, 'y': 20769}, {'x': 4022, 'y': 20737}, {'x': 4022, 'y': 20705}, {'x': 4022, 'y': 20673}, {'x': 4022, 'y': 20641}, {'x': 4025, 'y': 20609}, {'x': 4031, 'y': 20578}, {'x': 4037, 'y': 20547}, {'x': 4049, 'y': 20517}, {'x': 4063, 'y': 20488}, {'x': 4080, 'y': 20461}, {'x': 4099, 'y': 20435}, {'x': 4119, 'y': 20410}, {'x': 4141, 'y': 20387}, {'x': 4161, 'y': 20362}, {'x': 4183, 'y': 20339}, {'x': 4202, 'y': 20313}, {'x': 4225, 'y': 20291}, {'x': 4245, 'y': 20266}, {'x': 4263, 'y': 20251, 't': 3355}]]

# Example data
candidates = [
   strokes_ellipse1, strokes_ellipse2, strokes_rect_easy_one_strokes, strokes_rect_easy_two_strokes, strokes_rect_easy_three_strokes, strokes_rect_easy_four_strokes
]

# X = np.array([])
# for candidate in candidates:
#     X = np.append(X, extract_features(candidate))
# print(len(X))
print(extract_features(candidates[0]))
# # Extract features
X = np.array([
    extract_features(candidates[0]),  # Rectangle example
    extract_features(candidates[1]),  # Rectangle example
    # Add more examples...
])
# print(X)

# y = np.array([0, 0, 0, 0, 1, 1])  # Corresponding labels (0: Rectangle, 1: Circle)

# print(X, y)

# X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
# print(X_train, y_train)
# clf = svm.SVC(kernel='linear')
# clf.fit(X_train, y_train)

# y_pred = clf.predict(X_test)
# accuracy = accuracy_score(y_test, y_pred)
# print(f'Accuracy: {accuracy * 100:.2f}%')



# # Extract and visualize orientation features for the first candidate
# orientation_features = [compute_orientation_feature([candidates[0]], angle) for angle in [0, 45, 90, 135]]

# # Plot the feature images
# fig, axes = plt.subplots(1, 4, figsize=(12, 3))
# for ax, feature, angle in zip(axes, orientation_features, [0, 45, 90, 135]):
#     ax.imshow(feature, cmap='hot', interpolation='nearest')
#     ax.set_title(f'Orientation {angle}°')
# plt.show()




# # Split dataset into training set and test set
# X_train, X_test, y_train, y_test = train_test_split(cancer.data, cancer.target, test_size=0.3,random_state=109) # 70% training and 30% test

# #Create a svm Classifier
# clf = svm.SVC(kernel='linear') # Linear Kernel

# #Train the model using the training sets
# clf.fit(X_train, y_train)

# #Predict the response for test dataset
# y_pred = clf.predict(X_test)

# # Model Accuracy: how often is the classifier correct?
# print("Accuracy:",metrics.accuracy_score(y_test, y_pred))